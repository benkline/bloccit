<h1><%= @topic.name %></h1>
<% if user_is_authorized_for_topics? %>
  <%= link_to "Edit Topic", edit_topic_path, class: 'btn btn-sm btn-success' %>
  <%= link_to "Delete Topic", @topic, method: :delete, class: 'btn btn-sm btn-danger', data: { confirm: 'Are you sure you want to delete this topic?' } %>
<% end %>
<div class="row">
  <div class="col-md-8">
    <p class="lead">
      <%= render partial: "labels/list", locals: {labels: @topic.labels} %>
      <br />
      <%= @topic.description %>
    </p>
    <div>
      <div class="media">
        <div class="media-body">
          <h3>Comments!</h3>
          <%= render partial: 'comments/comment', locals: {comments: @topic.comments}%>
          <% if current_user %>
            <%= render partial: 'comments/form', locals: {topic: @topic, comment: Comment.new} %>
          <% end %><br /><br />
        </div>
      </div>
    </div>
    <div>
      <div class="row">
        <div class="col-md-8">
          <div class="media">
            <div class="media-body">
              <% @topic.posts.each do |post| %>
                <%= link_to post.title, topic_post_path(@topic, post) %><br />
                <%= render partial: "labels/list", locals: {labels: @topic.labels} %><br />
                  <small>
                    submitted <%= time_ago_in_words(post.created_at) %> ago by <%=post.user.name %> <br />
                    <%= post.comments.count %> Comments
                  </small><br /><br />
                <% end %>
                <% if current_user %>
                  <%= link_to "New Post", new_topic_post_path(@topic), class: 'btn btn-success' %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
